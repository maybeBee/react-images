!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("prop-types"),require("react"),require("aphrodite"),require("react-scrolllock"),require("aphrodite/no-important"),require("react-transition-group"),require("react-dom")):"function"==typeof define&&define.amd?define(["prop-types","react","aphrodite","react-scrolllock","aphrodite/no-important","react-transition-group","react-dom"],t):e.Lightbox=t(e.PropTypes,e.React,e.aphrodite,e.ScrollLock,e.aphrodite,e.ReactTransitionGroup,e.ReactDOM)}(this,function(e,t,n,o,r,i,a){"use strict";function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},e);return Object.keys(t).forEach(function(o){"object"===m(t[o])&&t[o]&&e[o]?n[o]=s(e[o],t[o]):n[o]=t[o]}),n}function l(e,t){var n=t.theme,o=e.direction,i=e.icon,a=e.onClick,l=e.size,c=w(e,["direction","icon","onClick","size"]),u=r.StyleSheet.create(s(E,n));return d.createElement("button",y({type:"button",className:r.css(u.arrow,u["arrow__direction__"+o],l&&u["arrow__size__"+l]),onClick:a,onTouchEnd:a},c),d.createElement(x,{fill:!!n.arrow&&n.arrow.fill||f.arrow.fill,type:i}))}function c(e,t){var n=t.theme,o=w(e,[]),i=r.StyleSheet.create(s(_,n));return d.createElement("div",y({id:"lightboxBackdrop",className:r.css(i.container)},o))}function u(e,t){var n=t.theme,o=e.caption,i=e.countCurrent,a=e.countSeparator,l=e.countTotal,c=e.showCount,u=w(e,["caption","countCurrent","countSeparator","countTotal","showCount"]);if(!o&&!c)return null;var h=r.StyleSheet.create(s(I,n)),p=c?d.createElement("div",{className:r.css(h.footerCount)},i,a,l):d.createElement("span",null);return d.createElement("div",y({className:r.css(h.footer)},u),o?d.createElement("figcaption",{className:r.css(h.footerCaption)},o):d.createElement("span",null),p)}function h(e,t){var n=t.theme,o=e.customControls,i=e.onClose,a=e.showCloseButton,l=e.closeButtonTitle,c=w(e,["customControls","onClose","showCloseButton","closeButtonTitle"]),u=r.StyleSheet.create(s(S,n));return d.createElement("div",y({className:r.css(u.header)},c),o||d.createElement("span",null),!!a&&d.createElement("button",{title:l,className:r.css(u.close),onClick:i},d.createElement(x,{fill:!!n.close&&n.close.fill||f.close.fill,type:"close"})))}function p(e,t){var n=e.index,o=e.src,i=e.thumbnail,a=e.active,l=e.onClick,c=t.theme,u=i||o,h=r.StyleSheet.create(s(T,c));return d.createElement("div",{className:r.css(h.thumbnail,a&&h.thumbnail__active),onClick:function(e){e.preventDefault(),e.stopPropagation(),l(n)},style:{backgroundImage:'url("'+u+'")'}})}e=e&&e.hasOwnProperty("default")?e.default:e;var d="default"in t?t.default:t;o=o&&o.hasOwnProperty("default")?o.default:o;var f={};f.container={background:"rgba(0, 0, 0, 0.8)",gutter:{horizontal:10,vertical:10},zIndex:2001},f.header={height:40},f.close={fill:"white"},f.footer={color:"white",count:{color:"rgba(255, 255, 255, 0.75)",fontSize:"0.85em"},height:40,gutter:{horizontal:0,vertical:5}},f.thumbnail={activeBorderColor:"white",size:50,gutter:2},f.arrow={background:"none",fill:"white",height:120};var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g=(function(){function e(e){this.value=e}function t(t){function n(r,i){try{var a=t[r](i),s=a.value;s instanceof e?Promise.resolve(s.value).then(function(e){n("next",e)},function(e){n("throw",e)}):o(a.done?"return":"normal",a.value)}catch(e){o("throw",e)}}function o(e,t){switch(e){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}(r=r.next)?n(r.key,r.arg):i=null}var r,i;this._invoke=function(e,t){return new Promise(function(o,a){var s={key:e,arg:t,resolve:o,reject:a,next:null};i?i=i.next=s:(r=i=s,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},b=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},w=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},C=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},k={arrowLeft:function(e){return'<svg width="43px" height="43px" viewBox="0 0 43 43">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g transform="translate(-170.000000, -979.000000)">\n            <g>\n                <g transform="translate(191.500000, 1000.500000) scale(-1, 1) translate(-191.500000, -1000.500000) translate(170.000000, 979.000000)">\n                    <circle id="Oval-6-Copy" fill="#D4D4D4" style="mix-blend-mode: screen;" cx="21.5" cy="21.5" r="21.5"/>\n                    <path d="M24.8890175,21.1969985 L16.6387878,12.6009507 C16.375306,12.337469 16.375306,12.0739912 16.6387878,11.8105095 L18.120865,10.3284323 C18.4172819,10.0649506 18.6807596,10.0484832 18.9113061,10.2790297 L28.9894311,20.8017779 C29.0882368,20.9005835 29.1376389,21.0323224 29.1376389,21.1969985 C29.1376389,21.3616745 29.0882368,21.4934134 28.9894311,21.5922191 L18.9113061,32.1149672 C18.6478244,32.3784489 18.3843467,32.3784489 18.120865,32.1149672 L16.6387878,30.5834874 C16.375306,30.3200057 16.375306,30.056528 16.6387878,29.7930463 L24.8890175,21.1969985 Z" fill="#1A1E31"/>\n                </g>\n            </g>\n        </g>\n    </g>\n</svg>'},arrowRight:function(){return'<svg width="43px" height="43px" viewBox="0 0 43 43">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g transform="translate(-1228.000000, -979.000000)">\n            <g>\n                <g transform="translate(1228.000000, 979.000000)">\n                    <circle fill="#0396EF" cx="21.5" cy="21.5" r="21.5"/>\n                    <path d="M24.8890175,21.1969985 L16.6387878,12.6009507 C16.375306,12.337469 16.375306,12.0739912 16.6387878,11.8105095 L18.120865,10.3284323 C18.4172819,10.0649506 18.6807596,10.0484832 18.9113061,10.2790297 L28.9894311,20.8017779 C29.0882368,20.9005835 29.1376389,21.0323224 29.1376389,21.1969985 C29.1376389,21.3616745 29.0882368,21.4934134 28.9894311,21.5922191 L18.9113061,32.1149672 C18.6478244,32.3784489 18.3843467,32.3784489 18.120865,32.1149672 L16.6387878,30.5834874 C16.375306,30.3200057 16.375306,30.056528 16.6387878,29.7930463 L24.8890175,21.1969985 Z" fill="#FFFFFF"/>\n                </g>\n            </g>\n        </g>\n    </g>\n</svg>'},close:function(){return'<svg width="28px" height="28px" viewBox="0 0 28 28" >\n    <g stroke-width="1" fill="none" fill-rule="evenodd">\n        <g transform="translate(-1232.000000, -645.000000)" fill="#E3E3E2">\n            <g>\n                <path d="M1246,645 C1249.87502,645 1253.17707,646.36457 1255.90625,649.09375 C1258.63543,651.82293 1260,655.124981 1260,659 C1260,662.875019 1258.63543,666.17707 1255.90625,668.90625 C1253.17707,671.63543 1249.87502,673 1246,673 C1242.12498,673 1238.82293,671.63543 1236.09375,668.90625 C1233.36457,666.17707 1232,662.875019 1232,659 C1232,655.124981 1233.36457,651.82293 1236.09375,649.09375 C1238.82293,646.36457 1242.12498,645 1246,645 Z M1252.75,663.6875 L1248.0625,659 L1252.8125,654.3125 C1253.0625,654.062499 1253.0625,653.812501 1252.8125,653.5625 L1251.4375,652.25 C1251.3125,652.124999 1251.1875,652.0625 1251.0625,652.0625 C1250.97917,652.0625 1250.875,652.124999 1250.75,652.25 L1246,656.875 L1241.25,652.25 C1241.125,652.124999 1241.02083,652.0625 1240.9375,652.0625 C1240.8125,652.0625 1240.6875,652.124999 1240.5625,652.25 L1239.25,653.5625 C1239,653.812501 1239,654.062499 1239.25,654.3125 L1244,659 L1239.25,663.75 C1239.16667,663.791667 1239.125,663.895832 1239.125,664.0625 C1239.125,664.229168 1239.16667,664.354166 1239.25,664.4375 L1240.5625,665.8125 C1240.64583,665.895834 1240.77083,665.9375 1240.9375,665.9375 C1241.10417,665.9375 1241.22917,665.895834 1241.3125,665.8125 L1246,661.0625 L1250.75,665.75 C1250.875,665.875001 1250.97917,665.9375 1251.0625,665.9375 C1251.1875,665.9375 1251.3125,665.875001 1251.4375,665.75 L1252.75,664.4375 C1252.875,664.354166 1252.9375,664.229168 1252.9375,664.0625 C1252.9375,663.937499 1252.875,663.812501 1252.75,663.6875 Z"/>\n            </g>\n        </g>\n    </g>\n</svg>'}},x=function(e){var t=e.fill,n=e.type,o=w(e,["fill","type"]),r=k[n];return d.createElement("span",y({dangerouslySetInnerHTML:{__html:r(t)}},o))};x.defaultProps={fill:"white"},l.defaultProps={size:"medium"},l.contextTypes={theme:e.object.isRequired};var E={arrow:{background:"none",border:"none",borderRadius:4,cursor:"pointer",outline:"none",padding:10,position:"absolute",top:"50%",WebkitTouchCallout:"none",userSelect:"none"},arrow__size__medium:{height:f.arrow.height,marginTop:f.arrow.height/-2,width:40,"@media (min-width: 768px)":{width:70}},arrow__size__small:{height:f.thumbnail.size,marginTop:f.thumbnail.size/-2,width:30,"@media (min-width: 500px)":{width:40}},arrow__direction__right:{right:f.container.gutter.horizontal},arrow__direction__left:{left:f.container.gutter.horizontal}};c.contextTypes={theme:e.object.isRequired};var _={container:{alignItems:"center",backgroundColor:f.container.background,boxSizing:"border-box",display:"flex",height:"100%",justifyContent:"center",left:0,paddingBottom:f.container.gutter.vertical,paddingLeft:f.container.gutter.horizontal,paddingRight:f.container.gutter.horizontal,paddingTop:f.container.gutter.vertical,position:"fixed",top:0,width:"100%",zIndex:f.container.zIndex}};u.contextTypes={theme:e.object.isRequired};var I={footer:{boxSizing:"border-box",color:f.footer.color,cursor:"auto",display:"flex",justifyContent:"space-between",left:0,lineHeight:1.3,paddingBottom:f.footer.gutter.vertical,paddingLeft:f.footer.gutter.horizontal,paddingRight:f.footer.gutter.horizontal,paddingTop:f.footer.gutter.vertical},footerCount:{color:f.footer.count.color,fontSize:f.footer.count.fontSize,paddingLeft:"1em"},footerCaption:{flex:"1 1 0"}};h.contextTypes={theme:e.object.isRequired};var S={header:{display:"flex",justifyContent:"space-between",height:f.header.height},close:{background:"none",border:"none",cursor:"pointer",outline:"none",position:"relative",top:0,verticalAlign:"bottom",height:40,marginRight:-10,padding:10,width:40}};p.contextTypes={theme:e.object.isRequired};var T={thumbnail:{backgroundPosition:"center",backgroundSize:"cover",borderRadius:2,boxShadow:"inset 0 0 0 1px hsla(0,0%,100%,.2)",cursor:"pointer",display:"inline-block",height:f.thumbnail.size,margin:f.thumbnail.gutter,overflow:"hidden",width:f.thumbnail.size},thumbnail__active:{boxShadow:"inset 0 0 0 2px "+f.thumbnail.activeBorderColor}},P=r.StyleSheet.create({paginatedThumbnails:{bottom:f.container.gutter.vertical,height:f.thumbnail.size,padding:"0 50px",position:"absolute",textAlign:"center",whiteSpace:"nowrap",left:"50%",transform:"translateX(-50%)"}}),L={height:f.thumbnail.size+2*f.thumbnail.gutter,width:40},z=function(e){function t(e){g(this,t);var n=C(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hasCustomPage:!1},n.gotoPrev=n.gotoPrev.bind(n),n.gotoNext=n.gotoNext.bind(n),n}return b(t,e),v(t,[{key:"componentWillReceiveProps",value:function(e){e.currentImage!==this.props.currentImage&&this.setState({hasCustomPage:!1})}},{key:"getFirst",value:function(){var e=this.props,t=e.currentImage,n=e.offset;return this.state.hasCustomPage?this.clampFirst(this.state.first):this.clampFirst(t-n)}},{key:"setFirst",value:function(e,t){var n=this.state.first;e&&(e.preventDefault(),e.stopPropagation()),n!==t&&this.setState({hasCustomPage:!0,first:t})}},{key:"gotoPrev",value:function(e){this.setFirst(e,this.getFirst()-this.props.offset)}},{key:"gotoNext",value:function(e){this.setFirst(e,this.getFirst()+this.props.offset)}},{key:"clampFirst",value:function(e){var t=this.props,n=t.images,o=2*t.offset+1;return e<0?0:e+o>n.length?n.length-o:e}},{key:"renderArrowPrev",value:function(){return this.getFirst()<=0?null:d.createElement(l,{direction:"left",size:"small",icon:"arrowLeft",onClick:this.gotoPrev,style:L,title:"Previous (Left arrow key)",type:"button"})}},{key:"renderArrowNext",value:function(){var e=this.props,t=e.offset,n=e.images,o=2*t+1;return this.getFirst()+o>=n.length?null:d.createElement(l,{direction:"right",size:"small",icon:"arrowRight",onClick:this.gotoNext,style:L,title:"Next (Right arrow key)",type:"button"})}},{key:"render",value:function(){var e=this.props,t=e.images,n=e.currentImage,o=e.onClickThumbnail,i=2*e.offset+1,a=[],s=0;return t.length<=i?a=t:(s=this.getFirst(),a=t.slice(s,s+i)),d.createElement("div",{className:r.css(P.paginatedThumbnails)},this.renderArrowPrev(),a.map(function(e,t){return d.createElement(p,y({key:s+t},e,{index:s+t,onClick:o,active:s+t===n}))}),this.renderArrowNext())}}]),t}(t.Component),O=function(e){function n(){return g(this,n),C(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return b(n,e),v(n,[{key:"getChildContext",value:function(){return this.props.context}},{key:"render",value:function(){return t.Children.only(this.props.children)}}]),n}(t.Component);O.childContextTypes={theme:e.object};var N=function(e){function t(){g(this,t);var e=C(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.portalElement=null,e}return b(t,e),v(t,[{key:"componentDidMount",value:function(){var e=document.createElement("div");document.body.appendChild(e),this.portalElement=e,this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){a.render(d.createElement(O,{context:this.context},d.createElement("div",null,d.createElement("style",null,"\n\t\t\t\t.fade-enter { opacity: 0.01; }\n\t\t\t\t.fade-enter.fade-enter-active { opacity: 1; transition: opacity 200ms; }\n\t\t\t\t.fade-leave { opacity: 1; }\n\t\t\t\t.fade-leave.fade-leave-active { opacity: 0.01; transition: opacity 200ms; }\n\t\t"),d.createElement(i.CSSTransitionGroup,y({component:"div",transitionName:"fade",transitionEnterTimeout:200,transitionLeaveTimeout:200},this.props)))),this.portalElement)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.portalElement)}},{key:"render",value:function(){return null}}]),t}(t.Component);N.contextTypes={theme:e.object.isRequired};var j=!("undefined"==typeof window||!window.document||!window.document.createElement),B=function(e){function t(e){g(this,t);var o=C(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.theme=s(f,e.theme),o.classes=n.StyleSheet.create(s(R,o.theme)),function(e){var t=this;e.forEach(function(e){return t[e]=t[e].bind(t)})}.call(o,["gotoNext","gotoPrev","closeBackdrop","handleKeyboardInput"]),o}return b(t,e),v(t,[{key:"getChildContext",value:function(){return{theme:this.theme}}},{key:"componentDidMount",value:function(){this.props.isOpen&&this.props.enableKeyboardInput&&window.addEventListener("keydown",this.handleKeyboardInput)}},{key:"componentWillReceiveProps",value:function(e){if(j){if(e.preloadNextImage){var t=this.props.currentImage,n=e.currentImage+1,o=e.currentImage-1,r=void 0;t&&e.currentImage>t?r=n:t&&e.currentImage<t&&(r=o),r?this.preloadImage(r):(this.preloadImage(o),this.preloadImage(n))}!this.props.isOpen&&e.isOpen&&e.enableKeyboardInput&&window.addEventListener("keydown",this.handleKeyboardInput),!e.isOpen&&e.enableKeyboardInput&&window.removeEventListener("keydown",this.handleKeyboardInput)}}},{key:"componentWillUnmount",value:function(){this.props.enableKeyboardInput&&window.removeEventListener("keydown",this.handleKeyboardInput)}},{key:"preloadImage",value:function(e){var t=this.props.images[e];if(t){var n=new Image;n.src=t.src,n.srcset=n.srcSet||n.srcset,t.srcset&&(n.srcset=t.srcset.join())}}},{key:"gotoNext",value:function(e){this.props.currentImage!==this.props.images.length-1&&(e&&(e.preventDefault(),e.stopPropagation()),this.props.onClickNext())}},{key:"gotoPrev",value:function(e){0!==this.props.currentImage&&(e&&(e.preventDefault(),e.stopPropagation()),this.props.onClickPrev())}},{key:"closeBackdrop",value:function(e){"lightboxBackdrop"!==e.target.id&&"FIGURE"!==e.target.tagName||this.props.onClose()}},{key:"handleKeyboardInput",value:function(e){return 37===e.keyCode?(this.gotoPrev(e),!0):39===e.keyCode?(this.gotoNext(e),!0):27===e.keyCode&&(this.props.onClose(),!0)}},{key:"renderArrowPrev",value:function(){return 0===this.props.currentImage?null:d.createElement(l,{direction:"left",icon:"arrowLeft",onClick:this.gotoPrev,title:this.props.leftArrowTitle,type:"button"})}},{key:"renderArrowNext",value:function(){return this.props.currentImage===this.props.images.length-1?null:d.createElement(l,{direction:"right",icon:"arrowRight",onClick:this.gotoNext,title:this.props.rightArrowTitle,type:"button"})}},{key:"renderDialog",value:function(){var e=this.props,t=e.backdropClosesModal,r=e.customControls,i=e.isOpen,a=e.onClose,s=e.showCloseButton,l=e.showThumbnails,u=e.width;if(!i)return d.createElement("span",{key:"closed"});var p=0;return l&&(p=this.theme.thumbnail.size+this.theme.container.gutter.vertical),d.createElement(c,{key:"open",onClick:t&&this.closeBackdrop,onTouchEnd:t&&this.closeBackdrop},d.createElement("div",{className:n.css(this.classes.content),style:{marginBottom:p,maxWidth:u}},d.createElement(h,{customControls:r,onClose:a,showCloseButton:s,closeButtonTitle:this.props.closeButtonTitle}),this.renderImages()),this.renderThumbnails(),this.renderArrowPrev(),this.renderArrowNext(),d.createElement(o,null))}},{key:"renderImages",value:function(){var e=this.props,t=e.currentImage,o=e.images,r=e.imageCountSeparator,i=e.onClickImage,a=e.showImageCount,s=e.showThumbnails;if(!o||!o.length)return null;var l=o[t];l.srcset=l.srcSet||l.srcset;var c=void 0,h=void 0;l.srcset&&(c=l.srcset.join(),h="100vw");var p=s?this.theme.thumbnail.size:0,f=this.theme.header.height+this.theme.footer.height+p+this.theme.container.gutter.vertical+"px";return d.createElement("figure",{className:n.css(this.classes.figure)},d.createElement("img",{className:n.css(this.classes.image),onClick:!!i&&i,sizes:h,alt:l.alt,src:l.src,srcSet:c,style:{cursor:this.props.onClickImage?"pointer":"auto",maxHeight:"calc(100vh - "+f+")"}}),d.createElement(u,{caption:o[t].caption,countCurrent:t+1,countSeparator:r,countTotal:o.length,showCount:a}))}},{key:"renderThumbnails",value:function(){var e=this.props,t=e.images,n=e.currentImage,o=e.onClickThumbnail,r=e.showThumbnails,i=e.thumbnailOffset;if(r)return d.createElement(z,{currentImage:n,images:t,offset:i,onClickThumbnail:o})}},{key:"render",value:function(){return d.createElement(N,null,this.renderDialog())}}]),t}(t.Component);B.defaultProps={closeButtonTitle:"Close (Esc)",currentImage:0,enableKeyboardInput:!0,imageCountSeparator:" of ",leftArrowTitle:"Previous (Left arrow key)",onClickShowNextImage:!0,preloadNextImage:!0,rightArrowTitle:"Next (Right arrow key)",showCloseButton:!0,showImageCount:!0,theme:{},thumbnailOffset:2,width:1024},B.childContextTypes={theme:e.object.isRequired};var R={content:{position:"relative"},figure:{margin:0},image:{display:"block",height:"auto",margin:"0 auto",maxWidth:"100%",WebkitTouchCallout:"none",userSelect:"none"}};return B});
